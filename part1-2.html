<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>1.2 What working with R looks like | Guide to R package</title>
  <meta name="description" content="1.2 What working with R looks like | Guide to R package">
  <meta name="generator" content="bookdown  and GitBook 2.6.7">

  <meta property="og:title" content="1.2 What working with R looks like | Guide to R package" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="1.2 What working with R looks like | Guide to R package" />
  
  
  

<meta name="author" content="author">


<meta name="date" content="2019-04-25">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="part-11.html">
<link rel="next" href="part-13.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />







<script src="libs/kePrint-0.0.1/kePrint.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="1" data-path="part-1.html"><a href="part-1.html"><i class="fa fa-check"></i><b>1</b> Introduction</a><ul>
<li class="chapter" data-level="1.1" data-path="part-11.html"><a href="part-11.html"><i class="fa fa-check"></i><b>1.1</b> Data science, or why we should learn R</a></li>
<li class="chapter" data-level="1.2" data-path="part1-2.html"><a href="part1-2.html"><i class="fa fa-check"></i><b>1.2</b> What working with R looks like</a><ul>
<li class="chapter" data-level="1.2.1" data-path="part1-2.html"><a href="part1-2.html#part_121"><i class="fa fa-check"></i><b>1.2.1</b> Example: Poland in the FIFA ranking</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="part-13.html"><a href="part-13.html"><i class="fa fa-check"></i><b>1.3</b> Setting up the environment</a><ul>
<li class="chapter" data-level="1.3.1" data-path="part-13.html"><a href="part-13.html#part_131"><i class="fa fa-check"></i><b>1.3.1</b> Installing basic R environment</a></li>
<li class="chapter" data-level="1.3.2" data-path="part-13.html"><a href="part-13.html#part_132"><i class="fa fa-check"></i><b>1.3.2</b> Installing RStudio</a></li>
<li class="chapter" data-level="1.3.3" data-path="part-13.html"><a href="part-13.html#part_133"><i class="fa fa-check"></i><b>1.3.3</b> Installing additional packages</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="part-14.html"><a href="part-14.html"><i class="fa fa-check"></i><b>1.4</b> Further information</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="part-2.html"><a href="part-2.html"><i class="fa fa-check"></i><b>2</b> R Basics</a><ul>
<li class="chapter" data-level="2.1" data-path="part-21.html"><a href="part-21.html"><i class="fa fa-check"></i><b>2.1</b> Loading data</a></li>
<li class="chapter" data-level="2.2" data-path="part-22.html"><a href="part-22.html"><i class="fa fa-check"></i><b>2.2</b> Data structures</a><ul>
<li class="chapter" data-level="2.2.1" data-path="part-22.html"><a href="part-22.html#part_221"><i class="fa fa-check"></i><b>2.2.1</b> Vectors</a></li>
<li class="chapter" data-level="2.2.2" data-path="part-22.html"><a href="part-22.html#part_222"><i class="fa fa-check"></i><b>2.2.2</b> Data frames</a></li>
<li class="chapter" data-level="2.2.3" data-path="part-22.html"><a href="part-22.html#part_223"><i class="fa fa-check"></i><b>2.2.3</b> Lists</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="part-23.html"><a href="part-23.html"><i class="fa fa-check"></i><b>2.3</b> Descriptive statistics</a><ul>
<li class="chapter" data-level="2.3.1" data-path="part-23.html"><a href="part-23.html#part_231"><i class="fa fa-check"></i><b>2.3.1</b> Quantitative variables</a></li>
<li class="chapter" data-level="2.3.2" data-path="part-23.html"><a href="part-23.html#part_232"><i class="fa fa-check"></i><b>2.3.2</b> Qualitative variables</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="part-24.html"><a href="part-24.html"><i class="fa fa-check"></i><b>2.4</b> Visual statistics</a><ul>
<li class="chapter" data-level="2.4.1" data-path="part-24.html"><a href="part-24.html#part_241"><i class="fa fa-check"></i><b>2.4.1</b> Bar plot, barplot() function</a></li>
<li class="chapter" data-level="2.4.2" data-path="part-24.html"><a href="part-24.html#part_242"><i class="fa fa-check"></i><b>2.4.2</b> Histogram, hist() function</a></li>
<li class="chapter" data-level="2.4.3" data-path="part-24.html"><a href="part-24.html#part_243"><i class="fa fa-check"></i><b>2.4.3</b> Box plot: boxplot()</a></li>
<li class="chapter" data-level="2.4.4" data-path="part-24.html"><a href="part-24.html#part_244"><i class="fa fa-check"></i><b>2.4.4</b> Kernel density estimator, density() function</a></li>
<li class="chapter" data-level="2.4.5" data-path="part-24.html"><a href="part-24.html#part_245"><i class="fa fa-check"></i><b>2.4.5</b> Scatter plot, scatterplot() function</a></li>
<li class="chapter" data-level="2.4.6" data-path="part-24.html"><a href="part-24.html#part_246"><i class="fa fa-check"></i><b>2.4.6</b> Mosaic plot, mosaicplot() function</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="part-25.html"><a href="part-25.html"><i class="fa fa-check"></i><b>2.5</b> How to process data with the dplyr package</a><ul>
<li class="chapter" data-level="2.5.1" data-path="part-25.html"><a href="part-25.html#part_251"><i class="fa fa-check"></i><b>2.5.1</b> How to filter rows</a></li>
<li class="chapter" data-level="2.5.2" data-path="part-25.html"><a href="part-25.html#part_252"><i class="fa fa-check"></i><b>2.5.2</b> How to choose columns</a></li>
<li class="chapter" data-level="2.5.3" data-path="part-25.html"><a href="part-25.html#part_253"><i class="fa fa-check"></i><b>2.5.3</b> How to create and transform variables</a></li>
<li class="chapter" data-level="2.5.4" data-path="part-25.html"><a href="part-25.html#part_254"><i class="fa fa-check"></i><b>2.5.4</b> How to sort rows</a></li>
<li class="chapter" data-level="2.5.5" data-path="part-25.html"><a href="part-25.html#part_255"><i class="fa fa-check"></i><b>2.5.5</b> How to work with streams</a></li>
<li class="chapter" data-level="2.5.6" data-path="part-25.html"><a href="part-25.html#part_256"><i class="fa fa-check"></i><b>2.5.6</b> How to compute aggregates/statistics in groups</a></li>
<li class="chapter" data-level="2.5.7" data-path="part-25.html"><a href="part-25.html#part_257"><i class="fa fa-check"></i><b>2.5.7</b> Wide and long formats</a></li>
<li class="chapter" data-level="2.5.8" data-path="part-25.html"><a href="part-25.html#part_258"><i class="fa fa-check"></i><b>2.5.8</b> Uniting/separating columns</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="part-26.html"><a href="part-26.html"><i class="fa fa-check"></i><b>2.6</b> How to load and save data in various formats</a><ul>
<li class="chapter" data-level="2.6.1" data-path="part-26.html"><a href="part-26.html#part_261"><i class="fa fa-check"></i><b>2.6.1</b> Loading data from text files</a></li>
<li class="chapter" data-level="2.6.2" data-path="part-26.html"><a href="part-26.html#part_262"><i class="fa fa-check"></i><b>2.6.2</b> Loading data from text files</a></li>
<li class="chapter" data-level="2.6.3" data-path="part-26.html"><a href="part-26.html#part_263"><i class="fa fa-check"></i><b>2.6.3</b> Saving data into text files</a></li>
<li class="chapter" data-level="2.6.4" data-path="part-26.html"><a href="part-26.html#part_264"><i class="fa fa-check"></i><b>2.6.4</b> Loading and saving JSON data</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Guide to R package</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="part1_2" class="section level2">
<h2><span class="header-section-number">1.2</span> What working with R looks like</h2>
<p>We work with R in an interactive way. The R software itself is often associated with a console that has a blinking cursor used to enter commands and read results.</p>
<p>We wanted to reflect this work style in this book, which is why we present sample code alongside the output generated by the software. Both R instructions and their results are presented against a grey background so that you can find them quickly. Results are presented on lines that start with a double hash sign (##).</p>
<p>For example, the <code>substr()</code> function cuts out a substring with the coordinates provided in the parentheses. When you run the R software, you only need to type the instruction below to see the result in the same console window. Here, the result will be a string containing a single <code>R</code> letter.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">substr</span>(<span class="st">&quot;What is supeR?&quot;</span>, <span class="dt">start =</span> <span class="dv">13</span>, <span class="dt">stop =</span> <span class="dv">13</span>)</code></pre>
<pre><code>## [1] &quot;R&quot;</code></pre>
<p>When we write about functions, packages, and language elements, we use a <code>fixed-width font</code>. Some key English terms are written in italics. When we first mention a function name from an untypical package, we mention the package name.</p>
<p>The <code>ggplot2::qplot()</code> notation signifies function <code>qplot()</code> in the <code>ggplot2</code> package. Sometimes, there are multiple functions in different packages that have the same name. In this case, we can precisely specify the function by providing the name of the package in front of it. When we need to install or turn on an uncommon package to use a given function, it is better to know which package offers the given function. At the end of this book, there is an index of functions – they are presented both alphabetically and by packages.</p>
<div id="part_121" class="section level3">
<h3><span class="header-section-number">1.2.1</span> Example: Poland in the FIFA ranking</h3>
<p>Let us find out what “serious” work with R looks like based on the example below.</p>
<ul>
<li><p>We will use some functions from the <code>rvest</code> package to directly read Poland’s FIFA rank from Wikipedia.</p></li>
<li><p>We will use some functions from the <code>tidyr</code> and <code>dplyr</code> packages to transform the data into the appropriate form.</p></li>
<li><p>We will use some functions from the <code>ggplot2</code> package to graphically present the data.</p></li>
</ul>
<p>The entire R code which deals with those 3 stages is quite short and easy to analyse in a step-by-step manner. Some elements may seem familiar while others will appear surprising. We will explain the meaning of each element in subsequent sections.</p>
<blockquote>
<p>All R instructions contained in this book can be downloaded from <a href="http://biecek.pl/R" class="uri">http://biecek.pl/R</a>.
The R instructions provided will always yield the same results. The only exception from this rule are some plots that have been modified to increase their readability in print.</p>
</blockquote>
<div id="part_1211" class="section level4">
<h4><span class="header-section-number">1.2.1.1</span> Loading data</h4>
<p>The code snippet below loads a data table from the Polish version of <em>Poland national football team</em> available on Wikipedia. We used <code>rvest</code>, a package which is very useful for downloading data from websites.</p>
<p>There are multiple tables on the site we are interested in. We get them all, and then choose the one with 14 columns. Having loaded the data, we show the first 6 rows.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;rvest&quot;</span>)
wikiPL &lt;-<span class="st"> &quot;https://pl.wikipedia.org/wiki/Reprezentacja_Polski_w_pi%C5%82ce_no%C5%BCnej_m%C4%99%C5%BCczyzn&quot;</span>
webpage &lt;-<span class="st"> </span><span class="kw">read_html</span>(wikiPL)
table_links &lt;-<span class="st"> </span><span class="kw">html_nodes</span>(webpage,<span class="dt">xpath=</span><span class="st">&#39;//*[@id=&quot;mw-content-text&quot;]/div/table[48]&#39;</span>)
tables &lt;-<span class="st"> </span><span class="kw">html_table</span>(table_links)
tab &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(tables)
tab &lt;-<span class="st"> </span>tab[<span class="op">-</span><span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">3</span>,<span class="dv">30</span>),]
<span class="kw">head</span>(tab)</code></pre>
<pre><code>##   Miesiąc.rok  I II III IV  V VI VII VIII IX  X XI XII
## 4        1993    NA     NA             20 22 23 26  28
## 5        1994  – 24  24 28 27 32  32    – 33 36 33  29
## 6        1995  – 32   – 34 36 29  32   28 28 27 33  33
## 7        1996 35 37   – 40 42  –  50   55 56 55 52  53
## 8        1997  – 56   – 52 57 57  51   53 50 45 47  48
## 9        1998  – 60  61 55 54  –  48   40 34 34 29  31</code></pre>
</div>
<div id="part_1212" class="section level4">
<h4><span class="header-section-number">1.2.1.2</span> Data transformation</h4>
<p>Another step after loading the data is cleaning and transforming it. To that end, we can use functions from the <code>tidyr</code> and <code>dplyr</code> packages. We will explain them in detail shortly. For the time being, we will provide an abbreviated explanation.</p>
<p>We change the data from the wide format, in which months are stored in different columns, into the narrow format, where all months are stored in a single column. Then, we change Roman numerals used for months into Arabic numerals. At this point, our data is ready to be presented graphically.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;tidyr&quot;</span>)
<span class="kw">library</span>(<span class="st">&quot;dplyr&quot;</span>)
<span class="kw">colnames</span>(tab)[<span class="dv">1</span>] &lt;-<span class="st"> &quot;Year&quot;</span>
<span class="kw">colnames</span>(tab)[<span class="dv">2</span><span class="op">:</span><span class="dv">13</span>] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span><span class="dv">12</span>
data_long &lt;-<span class="st"> </span><span class="kw">gather</span>(tab[,<span class="dv">1</span><span class="op">:</span><span class="dv">13</span>], Month, Position, <span class="op">-</span>Year)
data_long &lt;-<span class="st"> </span><span class="kw">mutate</span>(data_long,
                    <span class="dt">Position =</span> <span class="kw">as.numeric</span>(Position),
                    <span class="dt">Month =</span> <span class="kw">as.numeric</span>(Month))
<span class="kw">head</span>(data_long, <span class="dv">3</span>)</code></pre>
<pre><code>##   Year Month Position
## 1 1993     1       NA
## 2 1994     1       NA
## 3 1995     1       NA</code></pre>
</div>
<div id="part_1213" class="section level4">
<h4><span class="header-section-number">1.2.1.3</span> Graphical data presentation</h4>
<p>Now that we have loaded the data, it is time we looked at it. We can use the <code>ggplot2</code> package for graphical presentation purposes. Below, we present instructions that will generate the chart visible in Figure <a href="part1-2.html#fig:w01">1.3</a>, which is called a box plot. It presents the minimal, maximal, mid-range and interquartile rank of Poland in each year of the ranking. We can see when the most prominent changes took place and when Poland reached its best ranks.</p>
<pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ggplot2&quot;</span>)
<span class="kw">ggplot</span>(data_long, <span class="kw">aes</span>(<span class="kw">factor</span>(Year), Position)) <span class="op">+</span>
<span class="st">  </span><span class="kw">geom_boxplot</span>() <span class="op">+</span><span class="st"> </span><span class="kw">ggtitle</span>(<span class="st">&quot;Polish position in the FIFA ranking&quot;</span>) <span class="op">+</span><span class="st"> </span>
<span class="st">                   </span><span class="kw">xlab</span>(<span class="st">&quot;Date of publication of the ranking&quot;</span>) <span class="op">+</span>
<span class="st">                   </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">90</span>, <span class="dt">hjust =</span> <span class="dv">1</span>))</code></pre>
<div class="figure" style="text-align: center"><span id="fig:w01"></span>
<img src="Przewodnik_gitbook_80_files/figure-html/w01-1.png" alt="An example of a graph made using the ggplot2 package.The Polish position in the FIFA ranking is presented in various years.The last two years have seen a significant improvement." width="100%" />
<p class="caption">
Figure 1.3: An example of a graph made using the ggplot2 package.The Polish position in the FIFA ranking is presented in various years.The last two years have seen a significant improvement.
</p>
</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="part-11.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="part-13.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"google": false,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
},
"search": false
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(src))
      src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
